# GitHub Actions Runner Controller (ARC) - AutoscalingListener
#
# NOTE: This resource is typically auto-generated by the ARC controller
# when you deploy an AutoscalingRunnerSet with a listenerTemplate.
# This file is provided as a reference for the listener configuration.
#
# Before applying manually, you must:
#   1. Replace {organization-name-here} with your GitHub org or org/repo
#   2. Ensure the referenced secret exists in your cluster
#
apiVersion: actions.github.com/v1alpha1
kind: AutoscalingListener
metadata:
  labels:
    actions.github.com/organization: {organization-name-here}  # <-- REPLACE
    actions.github.com/scale-set-name: arc-runner-set
    actions.github.com/scale-set-namespace: arc-runners
    app.kubernetes.io/component: runner-scale-set-listener
    app.kubernetes.io/instance: arc-runner-set
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: arc-runner-set
    app.kubernetes.io/part-of: gha-runner-scale-set
    app.kubernetes.io/version: 0.13.0
    helm.sh/chart: gha-rs-0.13.0
  name: arc-runner-set-listener
  namespace: eks-arc-systems
spec:
  autoscalingRunnerSetName: arc-runner-set
  autoscalingRunnerSetNamespace: arc-runners
  githubConfigSecret: arc-runner-set-gha-rs-github-secret
  githubConfigUrl: https://github.com/{organization-name-here}  # <-- REPLACE (org or org/repo)
  image: ghcr.io/actions/gha-runner-scale-set-controller:0.13.0
  maxRunners: 10
  template:
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
              - matchExpressions:
                  - key: workload-type
                    operator: In
                    values:
                      - system
      containers:
        - image: ghcr.io/actions/gha-runner-scale-set-controller:0.13.0
          imagePullPolicy: Always
          name: listener
      tolerations:
        - effect: NoSchedule
          key: workload-type
          operator: Equal
          value: system
